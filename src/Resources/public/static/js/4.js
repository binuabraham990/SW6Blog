(this["webpackJsonpPlugintwo-hats-blog-module"]=this["webpackJsonpPlugintwo-hats-blog-module"]||[]).push([[4],{XbYG:function(e,i,o){"use strict";o.r(i);var a=Shopware,t=a.Component,n=a.Mixin,d=a.Context,l=(t.getComponentHelper().mapGetters,Shopware.Data.Criteria);i.default={template:'\n{% block sw_product_media_form %}\n    <sw-card \n        :title="$tc(\'twohats-blog.detail.cardTitleBlogMedia\')"\n        position-identifier="twohats-blog-detail-base-media"\n        :is-loading="isLoading"\n        >\n        <div\n            class="sw-product-media-form"\n            {#    :class="{ \'is--disabled\': disabled }"#}\n            >\n            \n            {% block sw_product_media_form_upload %}\n                <sw-upload-listener\n                    v-if="!isLoading"\n                    :upload-tag="blog.id"\n                    auto-upload\n                    @media-upload-finish="successfulUpload"\n                    @media-upload-fail="onUploadFailed"\n                    />\n\n                <sw-media-upload-v2\n                    v-if="!isLoading && acl.can(\'product.editor\')"\n                    variant="regular"\n                    :upload-tag="blog.id"\n                    :scroll-target="$parent.$el"\n                    :default-folder="blog.getEntityName()"\n                    @media-upload-sidebar-open="onOpenMedia"\n                    />\n            {% endblock %}\n\n            \n            {% block sw_product_media_form_grid %}\n                <div class="sw-product-media-form__previews">\n\n                    <div\n                        v-if="!isLoading"\n                        class="twohats-blog-media-form__grid twohats-blog-media-form__column"\n                        :style="gridAutoRows"\n                        >\n                        {%  block twohats_blog_media_form_grid_items %}\n                            <sw-product-image\n                                v-for="mediaItem in mediaItems"\n                                :key="mediaItem.id"\n                                v-draggable="{ dragGroup: \'blog-media\', data: mediaItem }"\n                                v-droppable="{ dragGroup: \'blog-media\', data: mediaItem }"\n                                :is-placeholder="mediaItem.isPlaceholder"\n                                :media-id="mediaItem.mediaId"\n                                />\n                        {% endblock %}\n                    </div>\n                    {#        <sw-loader v-else />#}\n                </div>\n            {% endblock %}\n        </div>\n    </sw-card>\n{% endblock %}\n',data:function(){return{isLoading:!1,showMediaModal:!1}},inject:["repositoryFactory","acl"],mixins:[n.getByName("notification")],props:{blog:{type:Object,required:!0,default:function(){return{}}},mediaId:{type:String,required:!1}},computed:{blogMediaRepository:function(){return this.repositoryFactory.create("twohats_blog_blog_media")},blogMedia:function(){return this.blog?this.blog.media:[]},mediaItems:function(){var e=this,i=new l;i.addFilter(l.equals("blogId",this.blog.id)),this.blogMediaRepository.search(i,d.api).then((function(i){var o=i.slice(),a=e.getPlaceholderCount(e.columnCount);if(0===a)return o;for(var t=0;t<a;t+=1)o.push(e.createPlaceholderMedia(o));return o}))},gridAutoRows:function(){return"grid-auto-rows: ".concat(this.columnWidth)}},methods:{successfulUpload:function(e){var i=e.targetId,o=this.createBlogMediaAssociation(i);this.blog.media.add(o)},onUploadFailed:function(e){console.log("upload failed")},onOpenMedia:function(){this.$emit("media-open"),this.showMediaModal=!0},createBlogMediaAssociation:function(e){var i=this.blogMediaRepository.create();return i.blogId=this.blog.id,i.mediaId=e,this.blog.media.length<=0?i.position=0:i.position=this.blog.media.length+1,i},getPlaceholderCount:function(e){this.blogMedia.length+3<2*e&&(e*=2);var i=e;return 0!==this.blogMedia.length&&(i=e-this.blogMedia.length%e)===e?0:i},createPlaceholderMedia:function(e){return{isPlaceholder:!0,isCover:0===e.length,media:{isPlaceholder:!0,name:""},mediaId:e.length.toString()}}}}}}]);